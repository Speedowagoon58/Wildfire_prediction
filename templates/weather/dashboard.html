{% extends "base.html" %} {% block title %}Weather Dashboard - Wildfire
Prediction System{% endblock %} {% block content %}
<div class="container">
  <h1 class="mb-4">Weather Dashboard</h1>

  <div class="row">
    <div class="col-md-8">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="card-title mb-0">Weather Map</h5>
        </div>
        <div class="card-body">
          <div id="map" class="weather-section" style="height: 500px"></div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Weather Summary</h5>
        </div>
        <div class="card-body weather-section">
          <div class="list-group">
            {% for data in weather_data %}
            <div class="list-group-item">
              <div class="d-flex justify-content-between align-items-center">
                <h6 class="mb-1">{{ data.region.name }}</h6>
                <span class="badge bg-{{ data.risk_color }}"
                  >{{ data.risk_level }} Risk</span
                >
              </div>
              <div class="small text-muted">
                <div>
                  Temperature: {{ data.weather.temperature|floatformat:0 }}째C
                </div>
                <div>Humidity: {{ data.weather.humidity|floatformat:0 }}%</div>
                <div>Wind: {{ data.weather.wind_speed|floatformat:0 }} m/s</div>
                <div>
                  Precipitation: {{ data.weather.precipitation|floatformat:0 }}
                  mm
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% block extra_js %}
<script>
  // Initialize the map
  var map = L.map('map').setView([31.7917, -7.0926], 6);

  // Add OpenStreetMap tiles
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
  }).addTo(map);

  // Add markers for each region
  {% for data in weather_data %}
  var marker = L.marker([{{ data.region.latitude }}, {{ data.region.longitude }}]).addTo(map);
  marker.bindPopup(`
    <strong>{{ data.region.name }}</strong><br>
    Risk Level: <span class="text-{{ data.risk_color }}">{{ data.risk_level }}</span><br>
    Temperature: {{ data.weather.temperature|floatformat:0 }}째C<br>
    Humidity: {{ data.weather.humidity|floatformat:0 }}%<br>
    Wind: {{ data.weather.wind_speed|floatformat:0 }} m/s<br>
    Precipitation: {{ data.weather.precipitation|floatformat:0 }} mm
  `);

  // Add a colored circle to indicate risk level
  L.circle([{{ data.region.latitude }}, {{ data.region.longitude }}], {
    color: '{{ data.risk_color }}',
    fillColor: '{{ data.risk_color }}',
    fillOpacity: 0.3,
    radius: 10000
  }).addTo(map);
  {% endfor %}

  function addWeatherMarker(weather) {
    const popupContent = `
      <div class="weather-popup">
        <h4>${weather.region.name}</h4>
        <p>Temperature: ${Math.round(weather.temperature)}째C</p>
        <p>Humidity: ${Math.round(weather.humidity)}%</p>
        <p>Wind Speed: ${Math.round(weather.wind_speed)} m/s</p>
        <p>Wind Direction: ${Math.round(weather.wind_direction)}째</p>
        <p>Precipitation: ${Math.round(weather.precipitation)} mm</p>
        <p>Pressure: ${Math.round(weather.pressure)} hPa</p>
      </div>
    `;
    // ... existing code ...
  }
</script>
{% endblock %} {% endblock %}
